# ==============================================================================
# Goldilocks Docker Infrastructure Environment Configuration
# HIGH COMPATIBILITY - Supports multiple environments and deployment targets
# MODERNIZE - Latest stable versions and best practices
# ==============================================================================

# -----------------------------------------------------------------------------
# Build & Runtime Configuration
# -----------------------------------------------------------------------------
# Python Version - Use stable version for compatibility with all dependencies
PYTHON_VERSION=3.12-slim
PYTHON_VERSION_BLEEDING_EDGE=3.14.0rc3-trixie
PYTHON_VERSION_STABLE=3.12-slim
PYTHON_VERSION_ALPINE=3.12-alpine

# Container Platform Support
TARGETPLATFORM=linux/amd64
BUILDPLATFORM=linux/amd64
DOCKER_BUILDKIT=1
BUILDKIT_INLINE_CACHE=1
BUILDX_EXPERIMENTAL=1
COMPOSE_DOCKER_CLI_BUILD=1

# Node.js for frontend tooling (if needed)
NODE_VERSION=21-alpine
NODE_VERSION_LTS=20-alpine

# -----------------------------------------------------------------------------
# Application Environment
# -----------------------------------------------------------------------------
# Environment Type
ENVIRONMENT=development
FLASK_ENV=development
FLASK_DEBUG=1
PYTHONUNBUFFERED=1
PYTHONDONTWRITEBYTECODE=1
PYTHONPATH=/app/src:/app

# Security Configuration
SECRET_KEY=dev-secret-key-change-in-production-$(date +%s)
JWT_SECRET_KEY=jwt-secret-key-change-in-production-$(date +%s)
CSRF_SECRET_KEY=csrf-secret-key-change-in-production-$(date +%s)

# Session Configuration
SESSION_PERMANENT=false
SESSION_USE_SIGNER=true
SESSION_KEY_PREFIX=goldilocks:session:
SESSION_REDIS=true

# -----------------------------------------------------------------------------
# Database Configuration - MariaDB Edge Computing Optimized
# -----------------------------------------------------------------------------
# Connection Settings
MARIADB_ROOT_PASSWORD=goldilocks_root_secure_2024
MARIADB_DATABASE=goldilocks
MARIADB_USER=goldilocks_app
MARIADB_PASSWORD=goldilocks_app_secure_2024

# Database URLs
DATABASE_URL=mysql+pymysql://goldilocks_app:goldilocks_app_secure_2024@goldilocks-db:3306/goldilocks?charset=utf8mb4
DATABASE_REPLICA_URL=mysql+pymysql://goldilocks_app:goldilocks_app_secure_2024@goldilocks-db-replica:3306/goldilocks?charset=utf8mb4

# Connection Pool Settings (HIGH COMPATIBILITY)
DB_POOL_SIZE=20
DB_POOL_MAX_OVERFLOW=30
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600
DB_POOL_PRE_PING=true

# Database Performance (LIGHTWEIGHT for edge computing)
MARIADB_INNODB_BUFFER_POOL_SIZE=256M
MARIADB_INNODB_LOG_FILE_SIZE=64M
MARIADB_INNODB_FLUSH_LOG_AT_TRX_COMMIT=2
MARIADB_QUERY_CACHE_SIZE=32M
MARIADB_MAX_CONNECTIONS=100

# -----------------------------------------------------------------------------
# Cache & Session Store Configuration
# -----------------------------------------------------------------------------
# Redis Configuration
REDIS_URL=redis://goldilocks-redis:6379/0
REDIS_SESSION_URL=redis://goldilocks-redis:6379/1
REDIS_CACHE_URL=redis://goldilocks-redis:6379/2
REDIS_CELERY_URL=redis://goldilocks-redis:6379/3

# Cache Settings
CACHE_TYPE=redis
CACHE_DEFAULT_TIMEOUT=300
CACHE_REDIS_PASSWORD=
CACHE_KEY_PREFIX=goldilocks:cache:

# -----------------------------------------------------------------------------
# Logging & Monitoring Configuration
# -----------------------------------------------------------------------------
# Logging Levels and Formats
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_DATE_FORMAT=%Y-%m-%dT%H:%M:%S%z

# Application Monitoring
ENABLE_METRICS=true
METRICS_PORT=9090
HEALTH_CHECK_INTERVAL=30
REQUEST_ID_HEADER=X-Request-ID

# Sentry Configuration (if used)
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# -----------------------------------------------------------------------------
# API & Web Server Configuration
# -----------------------------------------------------------------------------
# API Settings
API_VERSION=v1
API_PREFIX=/api/v1
API_RATE_LIMIT=100/hour
API_PAGE_SIZE=50
API_MAX_PAGE_SIZE=500

# Web Server Settings
WEB_PORT=9000
WEB_HOST=0.0.0.0
WEB_WORKERS=4
WEB_WORKER_CLASS=gevent
WEB_WORKER_CONNECTIONS=1000
WEB_MAX_REQUESTS=1000
WEB_MAX_REQUESTS_JITTER=50
WEB_TIMEOUT=30
WEB_KEEPALIVE=2

# CORS Configuration
CORS_ORIGINS=http://localhost:3000,http://localhost:9000
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOW_HEADERS=Content-Type,Authorization,X-Request-ID

# -----------------------------------------------------------------------------
# Email Configuration (if needed)
# -----------------------------------------------------------------------------
MAIL_SERVER=localhost
MAIL_PORT=1025
MAIL_USE_TLS=false
MAIL_USE_SSL=false
MAIL_USERNAME=
MAIL_PASSWORD=
MAIL_DEFAULT_SENDER=noreply@goldilocks.local

# -----------------------------------------------------------------------------
# File Storage Configuration
# -----------------------------------------------------------------------------
# Upload Settings
UPLOAD_FOLDER=/app/uploads
MAX_CONTENT_LENGTH=16777216  # 16MB
ALLOWED_EXTENSIONS=jpg,jpeg,png,gif,pdf,txt,csv,xlsx

# Static Files
STATIC_FOLDER=/app/frontend/static
STATIC_URL_PATH=/static

# -----------------------------------------------------------------------------
# Development & Testing Configuration
# -----------------------------------------------------------------------------
# Development Settings
DEBUG=1
TESTING=0
WTF_CSRF_ENABLED=false
WTF_CSRF_TIME_LIMIT=3600

# Testing Database
TEST_DATABASE_URL=sqlite:///:memory:
TEST_REDIS_URL=redis://goldilocks-redis:6379/15

# -----------------------------------------------------------------------------
# Container Health & Resource Configuration
# -----------------------------------------------------------------------------
# Resource Limits (LIGHTWEIGHT principle)
MEMORY_LIMIT=512m
CPU_LIMIT=1.0
MEMORY_RESERVATION=256m
CPU_RESERVATION=0.5

# Health Check Settings
HEALTHCHECK_INTERVAL=30s
HEALTHCHECK_TIMEOUT=10s
HEALTHCHECK_RETRIES=3
HEALTHCHECK_START_PERIOD=40s

# -----------------------------------------------------------------------------
# Alternative Python Versions for Different Environments
# -----------------------------------------------------------------------------
# Production (stable, security-focused)
# PYTHON_VERSION=3.12-slim
# PYTHON_VERSION=3.11-slim

# Edge Computing (minimal footprint)
# PYTHON_VERSION=3.12-alpine
# PYTHON_VERSION=3.11-alpine

# Enterprise (LTS support)
# PYTHON_VERSION=3.11-slim-bullseye
# PYTHON_VERSION=3.10-slim-bullseye

# Bleeding Edge (development only)
# PYTHON_VERSION=3.14.0rc3-trixie
# PYTHON_VERSION=3.13-trixie

# -----------------------------------------------------------------------------
# Compatibility Notes
# -----------------------------------------------------------------------------
# - All settings support environment variable override
# - Database URLs support multiple backends (PostgreSQL, MySQL, SQLite)
# - Cache backend can switch between Redis and Memcached
# - Logging supports both JSON and text formats
# - Container resources auto-scale based on available hardware
# - Multi-architecture support (amd64, arm64, arm/v7)
